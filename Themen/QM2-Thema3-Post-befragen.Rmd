---
title: "Thema 3: Die Posterior-Verteilung befragen"
subtitle: "QM2, ReThink, Kap. 3"
author: Prof. Sauer
date: WiSe 21
lang: de-DE
bibliography: /Users/sebastiansaueruser/Google Drive/Literatur/refmgt/library-ses.bib
institute: AWM, HS Ansbach
header-includes:
  - \usepackage{booktabs}
  - \usepackage{csquotes}
  - \usepackage{xspace}
  - \usepackage[ngerman]{babel}
output:
  beamer_presentation:
    toc: true
    theme: "Berkeley"
    #colortheme: "dolphin"
    # fonttheme: "structurebold"
    keep_tex: false 
    includes:
      in_header: ../libs/preamble.tex    
editor_options: 
  chunk_output_type: console
  
#numbersections: yes
csquotes: TRUE     
---


```{r global-knitr-options, include=FALSE}
knitr::opts_chunk$set(
  fig.pos = 'H',
  fig.asp = 0.618,
  fig.center = "align",
  fig.width = 5,
  out.width = "70%",
  fig.cap = "", 
  fig.path = "",
  echo = FALSE,
  message = FALSE,
  warning = FALSE,
  cache = FALSE,
  fig.show = "hold")

knitr::opts_knit$set(
  #base.dir = "img",
  root.dir = rprojroot::find_rstudio_root_file()
)

knitr::knit_hooks$set(crop = knitr::hook_pdfcrop)
```


```{r}
options("knitr.graphics.auto_pdf" = FALSE)
```


```{r echo = FALSE}
library(tidyverse)
library(knitr)
library(kableExtra)
#library(nomnoml)
#library(ggdag)
library(patchwork)
library(gt)
```

```{r}
source("R-Code/img.R")
```








```{r}
theme_set(theme_minimal())
```

# Post-Verteilung mit Stichproben zusammenfassen


## Zur Erinnerung, die Gittermethode

Die Gittermethode ist ein Weg, die Posteriori-Verteilung zu berechnen. Die Posteriori-Verteilung birgt viele nützliche Informationen.

So berechnen wir ein Gitter:

\footnotesize
```{r echo = TRUE}
n <- 1000
n_success <- 6
n_trials  <- 9

d <-
  tibble(p_grid = seq(from = 0, to = 1, length.out = n),
                  prior  = 1) %>% 
  mutate(likelihood = dbinom(n_success, 
                             size = n_trials, 
                             prob = p_grid)) %>% 
  mutate(unstand_post = (likelihood * prior),
         post = unstand_post / sum(unstand_post))

```


## Posteriori-Verteilung visualisiert

:::::: {.columns}
::: {.column width="50%"}
\tiny
```{r echo = FALSE}
head(d) 
```
::: 
::: {.column width="50%"}
\normalsize
```{r}
d %>% 
  ggplot() +
  aes(x = p_grid, y = post) +
  geom_point() +
  geom_line()
```

:::
::::::





## Wahrscheinlichkeiten sind kompliziert, Häufigkeiten einfacher

```{r echo = TRUE}
samples <-
  d %>% 
  slice_sample(n = 1e4,  # 10000
               weight_by = post, 
               replace = T)
```

\tiny
```{r}
glimpse(samples)
```


## Visualisieren wir die Stichproben aus der Post-Verteilung


```{r out.height=c("10%", "10%")}
samples %>% 
  mutate(sample_number = 1:n()) %>% 
  
  ggplot(aes(x = sample_number, y = p_grid)) +
  geom_point(alpha = 1/10) +
  scale_y_continuous("proportion of water (p)", limits = c(0, 1)) +
  xlab("sample number")


samples %>% 
  ggplot(aes(x = p_grid)) +
  geom_density(fill = "black") +
  scale_x_continuous("proportion of water (p)", limits = c(0, 1))
```

---

## W



# Hinweise 


## Zu diesem Skript

Dieses Skript bezieht sich auf folgende [Lehrbücher](#literatur): 


- Kapitel 3 aus @mcelreath_statistical_2020 

- R-Code stammt aus @kurz_statistical_2021


Dieses Skript wurde erstellt am `r Sys.time()`.



## Literatur {#literatur}

\tiny



<div id="refs"></div>


\normalsize
